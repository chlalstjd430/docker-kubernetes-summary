

# ğŸ³ 07.ë„ì»¤ ì»¨í…Œì´ë„ˆ ë°°í¬ - ë„ì»¤ ì»´í¬ì¦ˆë¡œ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸° ğŸ³

ë„ì»¤ë¥¼ ì‹¤ì œ ìš´ì˜ í™˜ê²½ì— ì ìš©í•  ë•Œ ë‹¨ì¼ ì»¨í…Œì´ë„ˆë§Œ ì´ìš©í•˜ëŠ” ê²½ìš°ëŠ” ë“œë¬¼ë‹¤. ì´ì— ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ë™ì‘ì„ ì œì–´í•˜ê¸° ìœ„í•œ ì„¤ì • íŒŒì¼ì´ë‚˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì–´ë–»ê²Œ ì „ë‹¬í•˜ì§€, ì»¨í…Œì´ë„ˆì˜ ì˜ì¡´ê´€ê³„ë¥¼ ê³ ë ¤í•  ë•Œ í¬íŠ¸ í¬ì›Œë”©ì„ ì–´ë–»ê²Œ ì„¤ì •í•´ì•¼ í•˜ëŠ”ì§€ ë“œìœ¼ì´ ìš”ì†Œë¥¼ ì ì ˆíˆ ê´€ë¦¬í•´ì•¼ í•œë‹¤.  
ì´ë–„ í•„ìš”í•œ ê²ƒì´ **ë„ì»¤ ì»´í¬ì¦ˆ(Docekr Compose)ë‹¤. 

## docker-compose ëª…ë ¹ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°
ComposeëŠ” yaml í¬ë§·ìœ¼ë¡œ ê¸°ìˆ ëœ ì„¤ì • íŒŒì¼ë¡œ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆì˜ ì‹¤í–‰ì„ í•œ ë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

ìš°ì„  ì–´ë–¤ ê¸°ëŠ¥ë“¤ì´ ìˆëŠ”ì§€ ì‚´í´ë³´ì. ìœˆë„ìš°/macOSìš© ë„ì»¤ë¥¼ ë¡œì»¬ì— ì„¤ì¹˜í•œ ê²½ìš° ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , [ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì€ ë³„ë„ ì„¤ì¹˜](https://hcnam.tistory.com/25)ê°€ í•„ìš”í•˜ë‹¤.

ë¨¼ì € ì»¨í…Œì´ë„ˆ í•˜ë‚˜ë¥¼ ì‹¤í–‰í•´ ë³´ê² ë‹¤. ê·¸ë¦¬ê³  ê°™ì€ ì‘ì—…ì„ docker-composerë¥¼ ì‚¬ìš©í•´ ë‹¤ì‹œ ìˆ˜í–‰í•  ê²ƒì´ë‹¤.  
~~~
$ docker container run -d -p 9000:8080 example/echo:latest
9eec9e85ef46b267e40518f108910e60528fcce9c7d643b8403681160d28217c
~~~

ì„ì˜ì˜ ë””ë ‰í„°ë¦¬ì—ì„œ docker-compose.ymlì´ë¼ëŠ” íŒŒì¼ëª…ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ ì‘ì„±í•œë‹¤.  
~~~yaml
version: "3"
services:
  echo:
    image: example/echo:latest
    ports:
      - 9000:8080
~~~

ì—¬ê¸°ì„œ version: "3" ë¶€ë¶„ì€ ì´ docker-compose.yml íŒŒì¼ì˜ ë‚´ìš©ì„ í•´ì„í•˜ëŠ” ë° í•„ìš”í•œ ë¬¸ë²•ì„ ì„ ì–¸í•œ ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ ë§Œë“  example/echo:latest ì´ë¯¸ì§€ë¥¼ ë„ì»¤ ì»´í¬ì¦ˆì—ì„œ ì‚¬ìš©í•´ ë³´ê² ë‹¤.  

services ìš”ì†Œ ì•„ë˜ì˜ echoëŠ” ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ, ê·¸ ì•„ë˜ì— ë‹¤ì‹œ ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í• ì§€ê°€ ì •ì˜ëœë‹¤. image ìš”ì†ŒëŠ” ë„ì»¤ ì´ë¯¸ì§€, portsëŠ” í¬íŠ¸ í¬ì›Œë”© ì„¤ì •ì„ ì§€ì •í•œë‹¤.

ì´ íŒŒì¼ì„ ì´ìš©í•´ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•´ ë³´ê² ë‹¤. í•´ë‹¹ íŒŒì¼ì´ ìœ„ì¹˜í•œ ë””ë ‰í„°ë¦¬ì—ì„œ ì´ ì •ì˜ì— ë”°ë¼ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ í•œêº¼ë²ˆì— ì‹œì‘í•˜ë ¤ë©´ **docker-compose up** ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

~~~
$ docker-compose up -d
Starting 02docker_compose_echo_1 ... done
choeminseong-ui-MacBook-Pro:02.docker_compo

$ docker container ls
CONTAINER ID        IMAGE                 COMMAND                  CREATED             STATUS              PORTS                    NAMES
7807cf538fbf        example/echo:latest   "go run /echo/main.go"   2 minutes ago       Up About a minute   0.0.0.0:9000->8080/tcp   02docker_compose_echo_1
~~~

ì»¨í…Œì´ë„ˆê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘ë˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í–ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì»¨í…Œì´ë„ˆë¥¼ ì •ì§€í•´ë³´ì. **docker-compose down** ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ docker-compose.yml íŒŒì¼ì— ì •ì˜ëœ ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ ì •ì§€ í˜¹ì€ ì‚­ì œëœë‹¤.

~~~
$ docker-compose down
Stopping 02docker_compose_echo_1 ... done
Removing 02docker_compose_echo_1 ... done
Removing network 02docker_compose_default
~~~

ì¼ì¼ì´ ì»¨í…Œì´ë„ˆ IDë¥¼ í™•ì¸í›„ ì§€ìš¸ í•„ìš”ê°€ ì—†ì–´ í›¨ì”¬ ê°„ë‹¨í•˜ë‹¤. ì´ë²ˆì—ëŠ” ì§€ë‚œë²ˆ ì‘ì„±í•œ main.goì™€ Dockerfileì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì— docker-compose.ymlì„ ì‘ì„±í›„ ì‹¤í–‰í•´ë³´ì.

docker-compose.yml

~~~yml
version: "3"
services:
  echo:
    build: .
    ports:
      - 9000:8080
~~~

~~~
$ docker-compose up -d --build
Creating network "01test_go_default" with the default driver
Building echo
Step 1/4 : FROM golang:1.9
 ---> ef89ef5c42a9
Step 2/4 : RUN mkdir /echo
 ---> Using cache
 ---> 24e37983e029
Step 3/4 : COPY main.go /echo
 ---> 290af47dafb2
Step 4/4 : CMD ["go", "run", "/echo/main.go"]
 ---> Running in 14c5efebddb9
Removing intermediate container 14c5efebddb9
 ---> 127a4a067c54
Successfully built 127a4a067c54
Successfully tagged 01test_go_echo:latest
Creating 01test_go_echo_1 ... done
~~~

ì´ë¡œì¨ docker-compose.yml íŒŒì¼ì„ ì‘ì„±í•˜ë©´ ê¸°ì¡´ docker ëª…ë ¹ì„ ì‚¬ìš©í•´ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë–„ ë§¤ë²ˆ ë¶€ì—¬í•˜ë˜ ì˜µì…˜ì„ ì„¤ì • íŒŒì¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì»´í¬ì¦ˆë¥¼ ì‚¬ìš©í•œ êµ¬ì„± ê´€ë¦¬ ê¸°ëŠ¥ì˜ ì§„ê°€ëŠ” ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë–„ ë°œíœ˜í•œë‹¤.

<br>

## ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°

ì»´í¬ì¦ˆë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ê¸°ë³¸ ìš”ì†Œë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ì  í‚¨ìŠ¤ë¥¼ ì˜ˆì œ ì‚¼ì•„ ì‹¤í–‰í•´ ë³´ì. ë‹¤ìŒê³¼ ê°™ì´ docekr-compose.yml íŒŒì¼ì„ ì‘ì„±í•œë‹¤.

~~~
version: "3"
services:
  master:
    container_name: master
    image: jenkins/jenkins:2.235.5-lts
    ports:
      - 8080:8080
    volumes:
      - ./jenkins_home:/var/jenkins_home
~~~

ì  í‚¨ìŠ¤ ì´ë¯¸ì§€ëŠ” ë„ì»¤ í—ˆë¸Œì— ì˜¬ë¼ì™€ ìˆëŠ” ê²ƒì„ ì´ìš©í•œë‹¤. volumesë¼ëŠ” ì„¤ì • í•­ëª©ì€ í˜¸ìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆ ì‚¬ì´ì— íŒŒì¼ì„ ë³µì‚¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ íŒŒì¼ì„ ê³µìœ í•  ìˆ˜ ìˆëŠ” ë§¤ì»¤ë‹ˆì¦˜ì´ë‹¤. Dockerfileì˜ COPY ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ë‚˜ container cp ëª…ë ¹ì€ ë¡œìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆ ì‚¬ì´ì— íŒŒì¼ì„ ë³µì‚¬í•˜ëŠ” ê¸°ëŠ¥ì´ì—ˆì§€ë§Œ, volumesëŠ” ê³µìœ ë¼ëŠ” ì ì—ì„œ ì°¨ì´ê°€ ìˆë‹¤. ì¦‰, í˜„ì¬ volumesë¥¼ ì´ìš©í•˜ì—¬ í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ ë°”ë¡œ ì•„ë˜ì— jenkins_home ë””ë ‰í„°ë¦¬ë¥¼ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆì˜ /var/jenkins_homeì— ë§ˆìš´íŠ¸í•œë‹¤.

ì´ì œ ì»´í¬ì¦ˆë¥¼ ì‹¤í–‰í•˜ëŠ”ë°, ì´ ë•Œ -d ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  í¬ì–´ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•˜ë©´ íŒ¨ìŠ¤ì›Œë“œê°€ ìƒì„±ë˜ëŠ”ë° ì´ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì˜ ë³µì‚¬í•´ ë†“ëŠ”ë‹¤.

~~~
$ docker-compose up
Creating network "02docker_compose_default" with the default driver
Pulling master (jenkins/jenkins:2.235.5-lts)...
2.142-slim: Pulling from jenkinsci/jenkins

...

master    | Sep 06, 2020 6:27:21 PM jenkins.install.SetupWizard init
master    | INFO: 
master    | 
master    | *************************************************************
master    | *************************************************************
master    | *************************************************************
master    | 
master    | Jenkins initial setup is required. An admin user has been created and a password generated.
master    | Please use the following password to proceed to installation:
master    | 
master    |                         **ë¹„ë°€ë²ˆí˜¸**
master    | 
master    | This may also be found at: /var/jenkins_home/secrets/initialAdminPassword
master    | 
master    | *************************************************************
master    | *************************************************************
master    | *************************************************************
master    | 
master    | Sep 06, 2020 6:27:29 PM hudson.model.UpdateSite updateData
master    | INFO: Obtained the latest update center data file for UpdateSource default

...

master    | INFO: Finished Download metadata. 13,358 ms
~~~

ì—¬ê¸°ì„œ ì  í‚¨ìŠ¤ë¥¼ í˜¸ìŠ¤íŠ¸ ìª½ í¬íŠ¸ 8080ê³¼ í¬íŠ¸ í¬ì›Œë”©ìœ¼ë¡œ ì—°ê²°í•˜ì˜€ìœ¼ë‹ˆ http://localhost:8080/ ì— ì ‘ì† í•´ë³´ì.

<p align = "center">
    <img src = "https://user-images.githubusercontent.com/50758600/92332744-00ba9580-f0bb-11ea-84ca-891558539164.png">
</p>

ì´í›„ ì•„ê¹Œ ë³µì‚¬í•´ë‘” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.

<p align = "center">
    <img src = "https://user-images.githubusercontent.com/50758600/92332745-01532c00-f0bb-11ea-8a6d-ba5139c0253c.png">
</p>

ì—¬ê¸°ì„œ ì„¸ì„¸í•œ ì„¤ì •ì€ ê±´ë“œë¦´ í•„ìš” ì—†ìœ¼ë‹ˆ, 'Install suggested plugins'ë¥¼ í´ë¦­í•œë‹¤. ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì¹˜ ê³¼ì •ì´ ë‚˜ì˜¬ ê²ƒì´ë‹¤.

<p align = "center">
    <img src = "https://user-images.githubusercontent.com/50758600/92332743-fdbfa500-f0ba-11ea-8ada-e08e63ef6529.png">
</p>

ì´í›„ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ í›„ ë¡œê·¸ì¸ í•˜ë©´ ì  í‚¨ìŠ¤ í™ˆ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.

<br>

## ë§ˆìŠ¤í„° ì  í‚¨ìŠ¤ ìš© SSH í‚¤ ìƒì„±

ì´ì œ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ í•˜ë‚˜ ì‹¤í–‰í–ˆë‹¤. ë‹¤ì‘ë¯„ ì¢€ ë” ì‹¤ìš©ì ì¸ ì˜ˆì œë¡œ, ì—¬ê¸°ì— ìŠ¬ë ˆì´ë¸Œ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ì¶”ê°€í•´ë³´ê² ë‹¤. ì‹¤ì œ ì  í‚¨ìŠ¤ ìš´ì˜í•  ë•Œ ë‹¨ì¼ ì„œë²„ë¡œ ìš´ì˜í•˜ê¸°ë³´ë‹¤ëŠ” ê´€ë¦¬ ê¸°ëŠ¥ì´ë‚˜ ì‘ì—… ì‹¤í–‰ ë“±ì€ ë§˜ìŠ¤í„° ì¸ìŠ¤í„°ìŠ¤ê°€ ë§¡ê³ , ì‘ì—…ì„ ì‹¤ì œë¡œ ì§„í–‰í•˜ëŠ” ê²ƒì€ ìŠ¬ë ˆì´ë¸Œ ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹´ë‹¹í•œë‹¤. ì´ëŸ¬í•œ êµ¬ì„±ì„ ì»´í¬ì¦ˆë¡œ ë§Œë“¤ì–´ ë³´ê² ë‹¤.

ë¨¼ì € ë§ˆìŠ¤í„°ê°€ ìŠ¬ë ˆì´ë¸Œì— ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ ë§ˆìŠ¤í„° ì»¨í…Œì´ë„ˆì—ì„œ SSH í‚¤ë¥¼ ìƒì„±í•œë‹¤.  
~~~
$ docker container exec -it master ssh-keygen -t rsa -C ""
Generating public/private rsa key pair.
Enter file in which to save the key (/var/jenkins_home/.ssh/id_rsa): 
Created directory '/var/jenkins_home/.ssh'.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /var/jenkins_home/.ssh/id_rsa.
Your public key has been saved in /var/jenkins_home/.ssh/id_rsa.pub.
~~~

ì§€ê¸ˆã… ë§Œë“  /var/jenkins_home/.ssh/id_rsa.pub íŒŒì¼ì€ ë§ˆìŠ¤í„° ì  í‚¨ìŠ¤ê°€ ìŠ¬ë ˆì´ë¸Œ ì  í‚¨ìŠ¤ì— ì ‘ì†í•  ë•Œ ì‚¬ìš©í•  í‚¤ë‹¤. ì´ í‚¤ë¥¼ ìŠ¬ë ˆì´ë¸Œë¥¼ ì¶”ê°€í•  ë•Œ ì„¤ì •í•  ê²ƒì´ë‹¤.

<br>

## ìŠ¬ë ˆì´ë¸Œ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ìƒì„±

ìŠ¬ë ˆì´ë¸Œ ì¸ìŠ¤í„´ìŠ¤ ì—­í• ì„ í•  ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ì¶”ê°€í•œë‹¤. ë§ˆìŠ¤í„° ì»¨í…Œì´ë„ˆëŠ” master, ìŠ¬ë ˆì´ë¸Œ ì»¨í…Œì´ë„ˆëŠ slave01ë¡œ ê°ê° ì´ë¦„ì„ ë¶™ì¸ë‹¤.

~~~
version: "3"
services:
  master:
    container_name: master
    image: jenkins/jenkins:2.235.5-lts
    ports:
      - 8080:8080
    volumes:
      - ./jenkins_home:/var/jenkins_home
    links:
      - slave01

  slave01:
    container_name: slave01
    image: jenkins/ssh-slave
    environment:
      - JENKINS_SLAVE_SSH_PUBKEY={í˜¸ìŠ¤íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œì˜ ./jenkins_home/.ssh/id_rsa.pub ì˜ ë‚´ìš©ì„ ë¶™ì—¬ë„£ëŠ”ë‹¤}
~~~

#### SSH ì ‘ì† í—ˆìš© ì„¤ì •

ìƒˆë¡œ ì¶”ê°€í•˜ëŠ” ìŠ¬ë ˆì´ë¸Œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ ë–„ëŠ” SSHë¡œ ì ‘ì†í•˜ëŠ” ìŠ¬ë ˆì´ë¸Œ ìš©ë„ë¡œ êµ¬ì„±ëœ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•œë‹¤. ìŠ¬ë ˆì´ë¸Œ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ í‚¤ë¥¼ ë°›ì•„ì˜¤ê±°ë‚˜ ì„¤ì •í•´ì„œëŠ” ì•ˆë˜ë©°, ì™¸ë¶€ í™˜ê²½ ë³€ìˆ˜ë¡œ ë°›ì•„ ì˜¤ê²Œ í•´ì•¼ í•œë‹¤.

#### SSH ì ‘ì† ëŒ€ìƒ ì„¤ì •

ì´ì œ ë§ˆìŠ¤í„° ì»¨í…Œì´ë„ˆê°€ ì–´ë–»ê²Œ ìŠ¬ë ˆì´ë¸Œ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì•„ ì¶”ê°€í•  ê²ƒì¸ê°€ í•˜ëŠ” ë¬¸ì œê°€ ë‚¨ì•„ ìˆë‹¤. IP ì£¼ì†Œë¥¼ ì°¾ì•„ ì„¤ì •í•˜ëŠ” ë°©ë²•ë„ ìˆì§€ë§Œ, ì»´í¬ì¦ˆë¥¼ ì‚¬ìš©í•˜ë©´ ì¢€ ë” ê¹”ë”í•˜ê²Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤. linkks: - slave01 ì´ ë°”ë¡œ ê·¸ ë°©ë²•ì´ë‹¤. ì´ê²ƒìœ¼ë¡œ masterì—ì„œ slave01ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ìŠ¬ë ˆì´ë¸Œ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì•„ê°ˆ ìˆ˜ ìˆë‹¤.

#### ì»¨í…Œì´ë„ˆ ê°„ì˜ ê´€ê³„ ì •ë¦¬ ë° ì¤€ë¹„ ì™„ë£Œ

ì§€ê¸ˆê¹Œì§€ ì‘ì—…í•œ ë””ë ‰í† ë¦¬ ìƒíƒœë¥¼ tree ëª…ë ¹ìœ¼ë¡œ í™•ì¸í•´ ë³´ì. treeê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ë‹¤ë©´ [í•´ë‹¹ ë¸”ë¡œê·¸](https://eunguru.tistory.com/150)ë¥¼ ì°¸ê³ í•˜ì.

~~~
$ tree -a -L 2
.
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ jenkins_home
    â”œâ”€â”€ .bash_history
    â”œâ”€â”€ .cache
    â”œâ”€â”€ .groovy
    â”œâ”€â”€ .java
    â”œâ”€â”€ .lastStarted
    â”œâ”€â”€ .owner
    â”œâ”€â”€ .ssh
    â”œâ”€â”€ com.cloudbees.hudson.plugins.folder.config.AbstractFolderConfiguration.xml
    â”œâ”€â”€ config.xml
    â”œâ”€â”€ copy_reference_file.log
    â”œâ”€â”€ hudson.model.UpdateCenter.xml
    â”œâ”€â”€ hudson.plugins.git.GitTool.xml
    â”œâ”€â”€ identity.key.enc
    â”œâ”€â”€ init.groovy.d
    â”œâ”€â”€ jenkins.CLI.xml
    â”œâ”€â”€ jenkins.install.InstallUtil.installingPlugins
    â”œâ”€â”€ jenkins.install.InstallUtil.lastExecVersion
    â”œâ”€â”€ jenkins.install.UpgradeWizard.state
    â”œâ”€â”€ jenkins.telemetry.Correlator.xml
    â”œâ”€â”€ jobs
    â”œâ”€â”€ logs
    â”œâ”€â”€ nodeMonitors.xml
    â”œâ”€â”€ nodes
    â”œâ”€â”€ plugins
    â”œâ”€â”€ queue.xml.bak
    â”œâ”€â”€ secret.key
    â”œâ”€â”€ secret.key.not-so-secret
    â”œâ”€â”€ secrets
    â”œâ”€â”€ updates
    â”œâ”€â”€ userContent
    â”œâ”€â”€ users
    â”œâ”€â”€ war
    â””â”€â”€ workflow-libs
~~~

ì´ì œ docker-compose.yml ì´ ì‘ì„±ë˜ì—ˆìœ¼ë‹ˆ í•´ë‹¹ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ì‹œ ì»´í¬ì¦ˆë¥¼ ì‹¤í–‰í•´ë³´ì. ì´í›„ docker-compose ps ëª…ë ¹ìœ¼ë¡œ í™•ì¸í•´ë³´ë©´ masterì™€ slave01ì´ë¼ëŠ” ì´ë¦„ì´ ë¶™ì€ ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ëìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

~~~
$ docker-compose up -d
Pulling slave01 (jenkins/ssh-slave:)...
latest: Pulling from jenkins/ssh-slave
f15005b0235f: Pull complete

...

Status: Downloaded newer image for jenkins/ssh-slave:latest
Creating slave01 ... done
Recreating master ... done

$ docker-compose ps
 Name                Command               State                 Ports              
------------------------------------------------------------------------------------
master    /sbin/tini -- /usr/local/b ...   Up      50000/tcp, 0.0.0.0:8080->8080/tcp
slave01   setup-sshd                       Up      22/tcp      
~~~

#### ë§ˆì§€ë§‰ ì„¤ì •

ë‘ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í–ˆë‹¤ê³  í•´ì„œ ë§ˆìŠ¤í„° ì  í‚¨ìŠ¤ê°€ ìŠ¬ë ˆì´ë¸Œ ì  í‚¨ìŠ¤ë¥¼ ì¸ì‹í•˜ì§€ëŠ” ëª»í•œë‹¤. ì´ì— ì‹¤ì œë¡œ ì  í‚¨ìŠ¤ í˜ì´ì§€ì—ì„œ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•œë‹¤.  
ë¨¼ì € ë‹¤ì‹œí•œë²ˆ 'http://localhost:8080/' ì— ì ‘ì†í•˜ê³ , ì™¼ìª½ ë©”ë‰´ì— 'Jenkins ê´€ë¦¬' í´ë¦­ í›„ 'ë…¸ë“œ ê´€ë¦¬'ì— ë“¤ì–´ê°„ë‹¤. ê·¸ë¦¬ê³  ì™¼ìª½ ë©”ë‰´íƒ­ì˜ 'ì‹ ê·œ ë…¸ë“œ'ë¥¼ í´ë¦­í•´ì£¼ê³  ë‹¤ìŒê³¼ ê°™ì€ ì ˆì°¨ë¥¼ ë”°ë¥¸ë‹¤.

ë…¸ë“œëª…ì€ 'slave01'ë¡œ ì •í•˜ê³ , Premanet Agentì— ì²´í¬í•´ì£¼ì

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-09-07 á„‹á…©á„’á…® 6 05 04](https://user-images.githubusercontent.com/50758600/92371669-db6b6d00-f136-11ea-9efb-f4fb23b335ff.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-09-07 á„‹á…©á„’á…® 6 23 06](https://user-images.githubusercontent.com/50758600/92371955-4321b800-f137-11ea-8497-101a16761485.png)


ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¤ëŠ”ë°, 'Remote root directory'ëŠ” ë³¸ì¸ì´ ì›í•˜ëŠ” ë””ë ‰í† ë¦¬ë¥¼ ì•„ë¬´ê±°ë‚˜ ì„¤ì •í•´ë„ ëœë‹¤. ê·¸ë¦¬ê³  '	Launch method'ë¥¼ 'Launch agents via SSH' ë¡œ ì„¤ì •í•´ì¤€ë‹¤. ì—¬ê¸°ì„œ 'Host' ê°’ì€ slave01ë¡œ ì…ë ¥í•˜ë©´, êµ³ì´ slave01ì˜ IP ì£¼ì†Œë¥¼ ì°¾ì•„ ì…ë ¥í•  í•„ìš” ì—†ì´ master ì»¨í…Œì´ë„ˆì—ì„œ slave01ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì•„ì˜¬ ìˆ˜ ìˆë‹¤. 'Credentials'ì€ Addë¥¼ ëˆŒëŸ¬ í’€ë‹¤ìš´ ë©”ë‰´ì—ì„œ Jenkinsë¥¼ ì„ íƒí•´ ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-09-07 á„‹á…©á„’á…® 6 36 01](https://user-images.githubusercontent.com/50758600/92373241-ffc84900-f138-11ea-9360-5878958a65e7.png)

ê·¸ëŸ¬ë©´ 'kind'ë¥¼ SSH Username with private keyë¡œ ë°”ê¾¸ê³ , 'Username'ì€ Jenkins, Private KeyëŠ” ë¯¸ìŠ¤í„° ì  í‚¤ìŠ¤ì˜ /.ssh/id_rsaë¥¼ ì„ íƒí•œë‹¤. ê·¸ë¦¬ê³  'Add'ë¥¼ ëˆ„ë¥¸ ë’¤ 'Credentials'ì— Jenkinsë¥¼ ì¶”ê°€í•´ì£¼ê³ , 'Host Key Verification Startegy'ë„ ë‹¤ìŒê³¼ ê°™ì´ ë°”ê¿”ì£¼ì.

- id_rsa ì˜ í‚¤ê°€ pass phraseê°€ ì œê±°ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ [ì´ ë¸”ë¡œê·¸](https://m.blog.naver.com/PostView.nhn?blogId=websearch&logNo=220326799080&proxyReferer=https:%2F%2Fwww.google.com%2F)ë¥¼ ì°¸ê³ í•˜ì.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-09-07 á„‹á…©á„’á…® 6 37 26](https://user-images.githubusercontent.com/50758600/92373386-32724180-f139-11ea-88fd-bfd83f8216f6.png)

ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ 'Save'í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-09-07 á„‹á…©á„’á…® 8 15 46](https://user-images.githubusercontent.com/50758600/92382051-ee863900-f146-11ea-9065-3634c9d8e0a7.png)

- ì°¸ê³ ë¡œ java ê²½ë¡œë¥¼ ëª»ì°¾ëŠ” ì˜¤ë¥˜ê°€ ìƒê¸¸ ê²½ìš° [ì´ ê¸€](https://github.com/chlalstjd430/debugging-note/blob/master/01.%20CICD/jenkins%EC%97%90%EC%84%9C%20java%20%EA%B2%BD%EB%A1%9C%EB%A5%BC%20%EB%AA%BB%20%EC%B0%BE%EB%8A%94%20%EC%98%A4%EB%A5%98.md)ì„ ì°¸ê³ í•˜ì


ì´ë ‡ê²Œ ì»´í¬ì¦ˆë¥¼ ì´ìš©í•´ ë§ˆìŠ¤í„°/ìŠ¬ë ˆì´ë¸Œë¡œ êµ¬ì„±ëœ ì  í‚¨ìŠ¤ë¥¼ êµ¬ì¶•í–ˆë‹¤. ë¬¼ë¡  í•´ë‹¹ ì‘ì—…ì—ì„œëŠ” ì•½ê°„ì˜ ìˆ˜ì‘ì—…ë„ ì§„í–‰í•˜ì˜€ë‹¤. ê·¸ë ‡ë‹´ë©´ ë‹¤ìŒ ê¸€ì—ì„œ ì„¤ì •ë§Œìœ¼ë¡œ ë„ì»¤ êµ¬ì„± ê´€ë¦¬ë¥¼ ì™„ì„±í•  ìˆ˜ ìˆë„ë¡ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ì§€ ê·¸ ê¸°ë³¸ì ì¸ ë‚´ìš©ì„ ì•Œì•„ë³´ê² ë‹¤.


<br>
<br>
<br>

**ì°¸ê³ **

[ë„ì»¤/ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ í™œìš©í•œ ì»¨í…Œì´ë„ˆ ê°œë°œ ì‹¤ì „ ì…ë¬¸](http://www.yes24.com/Product/Goods/70893433)
